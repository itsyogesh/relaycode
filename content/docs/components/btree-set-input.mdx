---
title: BTreeSet Input
description: Unique-value collection editor for Substrate BTreeSet types with duplicate detection
---

# BTreeSet Input

The BTreeSet input handles Substrate `BTreeSet<T>` types by rendering a dynamic list of sub-inputs with automatic duplicate detection. Each item's type is resolved from the chain metadata and rendered with the appropriate component. It supports both form mode for individual item editing and a JSON mode for bulk entry. BTreeSets appear in Substrate wherever a parameter expects a collection of unique, ordered values.

## Supported Type Names

The BTreeSet component matches the following type name pattern at **priority 41**:

- Any type name matching `/^BTreeSet</` (e.g. `BTreeSet<AccountId32>`, `BTreeSet<u32>`)

## Props

The component extends `ParamInputProps` with a required `typeId`:

| Prop | Type | Required | Description |
|---|---|---|---|
| `name` | `string` | Yes | Field identifier used as a prefix for item IDs |
| `label` | `string` | No | Display label shown above the list |
| `description` | `string` | No | Help text shown below the list |
| `typeName` | `string` | No | The SCALE type name (e.g. `"BTreeSet<AccountId32>"`) |
| `isDisabled` | `boolean` | No | Disables all controls and item inputs |
| `isRequired` | `boolean` | No | Shows a red asterisk next to the label |
| `error` | `string` | No | Validation error message to display |
| `client` | `DedotClient<PolkadotApi>` | Yes | Connected Dedot client for resolving the element type |
| `typeId` | `number` | Yes | Metadata type ID for the BTreeSet type |
| `value` | `any` | No | Externally controlled value |
| `onChange` | `(value: unknown) => void` | No | Callback fired with the array of unique values |

## Features

- **Auto-resolves element type**: Reads the BTreeSet's metadata structure (a `Sequence` in SCALE) to find the element type ID, then resolves it to the correct input component via `findComponent`.
- **Duplicate detection**: After every change, compares items by JSON serialization and displays a validation error when duplicates are found.
- **Add/Remove items**: An "Add Item" button appends new items; each item has a remove button (minimum one item).
- **JSON bulk mode**: A toggle switches between form mode and JSON mode, where users can paste a JSON array of values.
- **Bidirectional sync**: Switching between form and JSON modes preserves data by serializing/deserializing the current items.

## Type Resolution

```ts
import { findComponent } from "@/lib/input-map";

// Matched by /^BTreeSet</ at priority 41
findComponent("BTreeSet<AccountId32>", 22, client);
findComponent("BTreeSet<u32>", 28, client);
```

## Usage

The BTreeSet component is rendered by the extrinsic builder when a parameter type starts with `BTreeSet<`. Direct usage:

```tsx
import { BTreeSet } from "@/components/params/inputs/btree-set";

<BTreeSet
  name="validators"
  label="Validator Set"
  description="Set of unique validator accounts"
  client={client}
  typeId={22}
  onChange={(val) => console.log("Set:", val)}
/>
```

## Validation

The component uses a Zod schema that expects an array of any values:

```ts
const schema = z.array(z.any());
```

Additionally, runtime validation checks for duplicate values using JSON serialization comparison and displays a "Set contains duplicate values" error when duplicates are detected.

## Value Format

The `onChange` callback receives an **array of defined values** (items that are `undefined` are filtered out):

```ts
// BTreeSet<AccountId32>
["5GrwvaEF...", "5FHneW46...", "5DAAnrj7..."]

// BTreeSet<u32>
["1", "2", "3"]
```

The array should contain unique values. While the component warns about duplicates, it still emits the full array to let the parent track state.
